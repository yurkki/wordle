package org.example.wordle.service;

import org.springframework.stereotype.Service;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Arrays;
import java.util.List;

/**
 * Сервис для управления ежедневными словами
 */
@Service
public class DailyWordService {

    private final List<String> dailyWords = Arrays.asList(
            "УСПЕХ", "АВТОР", "БАГАЖ", "ВЕТКА", "ГЛАЗА", "ЖИЗНЬ", "ИГРОК",
            "КАРТА", "ЛЕСОК", "МАСКА", "НОЖКА", "ПАРТА", "РЫБАК", "ТАБЛО",
            "ФИЛЬМ", "ШАПКА", "ЭКРАН", "АБЗАЦ",
            "АГЕНТ", "АДРЕС", "АЗАРТ", "АЗИАТ", "АКРЫЛ", "АКТИВ", "АЛМАЗ", "АЛЬБА", "АМБАР", "АМПЕР",
            "АНГАР", "АНИСА", "АПЕЛЬ", "АРБУЗ", "АРЕНА", "АРХИВ", "АСТРА", "АТЛАС", "БАЗАР", "БАЙКА",
            "БАЛЕТ", "БАНАН", "БАРЖА", "БАСНЯ", "БАТОН", "БЕГУН", "БЕЛКА", "БЕРЕГ", "БИЛЕТ", "БИРЖА",
            "БОКАЛ", "БОМБА", "БОРОН", "ВАГОН", "ВАЗОН", "ВАЛЕТ", "ВАЛЬС",
            "ВАННА", "ВЕСНА", "ВИДЕО", "ВИЛКА", "ВОЛНА", "ВОРОТ", "ВЫБОР",
            "АКТЁР", "АМЁБА", "АФЁРА", "АКЦИЯ", "АЛЛЕЯ", "АРМИЯ",
            "БРАВО", "БРАГА", "БРАГИ", "БРАДА", "БРАМА", "БРАНЬ", "БРАСС",
            "БРЕЙК", "БРЕМЯ", "БРЕНД", "БРЕНЬ", "БРЕШЬ",
            "ВОПЁЖ", "ВОРЬЁ", "ВАФЛЯ",
            "ГАЯТЬ", "ГЕВЕЯ", "ГИЛЯК", "ГИНЕЯ", "ГЛАМЯ", "ГЛЯДИ", "ГЛЯДЬ", "ГЛЯЖУ", "ГЛЯСЕ", "ГЛЯЧЕ",
            "ГОЛЯК", "ДЕНЁК", "ДОМЁК", "ДВОЯК", "ЗАЛЁТ", "ЗЯТЁК", "ЗАВЕЯ", "ЗАРЯД", "ЗАТЕЯ", "ЗБРУЯ",
            "КЛЁШИ", "КОВЁР", "КОЗЁЛ", "КОНЁК", "КОПЬЁ", "КОТЁЛ", "КУЛЁК", "КУТЁЖ", "КАПЛЯ",
            "ЛАРЁК", "ЛИКЁР", "ЛИНЁК", "ЛИТЬЁ", "ЛАДЬЯ", "ЛАЗНЯ", "ЛЕПНЯ",
            "ЛИЛИЯ", "БИЛЕТ", "КНИГА", "ВЕСНА", "ОГОНЬ", "ДРОВА", "ПЕСОК", "СТЕПЬ", "ГОРОД", "ПТИЦА",
            "РУЧЕЙ", "КАМНИ", "ЛЫЖНЯ", "ЧАЙКА", "САХАР", "СЕДЛО", "ПОЕЗД", "ЛАМПА",
            "ДИВАН", "РУЧКА", "КИСТЬ", "ТАНЕЦ", "ЗАРЯД", "ШАПКА", "ОБУВЬ", "НИТКА", "ТКАНЬ",
            "ЖИЛЕТ", "НОСКИ", "САПОГ", "РАМКА", "ФИЛЬМ", "СЦЕНА", "АКТЁР", "РОЛИК", "ДУБЛЬ", "СЮЖЕТ",
            "МЫСЛЬ", "РИФМА", "БУКВА", "ШКОЛА", "КЛАСС", "НАУКА", "ХИМИЯ", "ЧИСЛО", "ПАПКА",
            "ТЕКСТ", "ШРИФТ", "СКРИП", "ДОМЕН", "ПОЧТА", "ДРАЙВ"
    );
    
    /**
     * Получить слово дня для указанной даты
     */
    public String getWordForDate(LocalDate date) {
        // Используем хеш от даты для получения индекса слова
        int dayOfYear = date.getDayOfYear();
        
        // Фильтруем только 5-буквенные слова
        List<String> fiveLetterWords = dailyWords.stream()
            .filter(word -> word.length() == 5)
            .toList();
        
        if (fiveLetterWords.isEmpty()) {
            // Если нет 5-буквенных слов, возвращаем первое слово из списка
            return dailyWords.get(0);
        }
        
        // Используем индекс для выбора из 5-буквенных слов
        int wordIndex = dayOfYear % fiveLetterWords.size();
        return fiveLetterWords.get(wordIndex);
    }
    
    /**
     * Получить слово дня для сегодняшней даты
     */
    public String getTodayWord() {
        return getWordForDate(LocalDate.now());
    }
    
    /**
     * Проверить, является ли слово словом дня
     */
    public boolean isTodayWord(String word) {
        return word != null && word.equalsIgnoreCase(getTodayWord());
    }
    
    /**
     * Получить дату в формате строки для отображения
     */
    public String getTodayDateString() {
        return LocalDate.now().format(DateTimeFormatter.ofPattern("dd MMMM yyyy"));
    }
}

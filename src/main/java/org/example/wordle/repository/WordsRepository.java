package org.example.wordle.repository;

import org.springframework.stereotype.Repository;

import java.util.Arrays;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

/**
 * Репозиторий для работы со словами
 */
@Repository
public class WordsRepository {

    private final List<String> allWords;
    private final List<String> fiveLetterWords;
    private final Set<String> validWords;

    public WordsRepository() {
        this.allWords = Arrays.asList(
                "АБЗАЦ", "АВТОР", "АГЕНТ", "АДРЕС", "АЗАРТ", "АЗИАТ", "АКТИВ", "АЛМАЗ",
                "АМПЕР", "АНГАР", "АРБУЗ", "АРЕНА", "АРХИВ", "АТЛАС",
                "БАГАЖ", "БАЗАР", "БАЙКА", "БАЛЕТ", "БАНАН", "БАРЖА", "БАСНЯ", "БАТОН", "БЕГУН", "БЕЛКА",
                "БЕРЕГ", "БИЛЕТ", "БИРЖА", "БОКАЛ", "БОМБА",
                "ВАГОН", "ВАЗОН", "ВАЛЕТ", "ВАЛЬС", "ВАННА", "ВЕСНА", "ВЕТКА", "ВИДЕО", "ВИЛКА",
                "ВОЛНА", "ВОРОТ", "ВЫБОР", "ГАЗОН", "ГАММА", "ГАРАЖ",
                "ГЕРОЙ", "ГОЛОС", "ГОРКА", "ГРУША", "ГУСАК", "ДАВКА",
                "ДЕБЕТ", "ДЕТКА", "ДИВАН", "ДОБРО",
                "ДОСКА", "ДОЧКА", "ДУБОК", "ЕПАРХ", "ЕРЕСЬ", "ЖАТВА", "ЖИВОТ",
                "ЗАБОР", "ЗАВОД", "ЗАГАР", "ЗАКАЗ", "ЗАМОК", "ЗАПАД", "ЗЕБРА", "ЗЕМЛЯ",
                "ИДЕАЛ", "ИКОНА", "ИСТОК", "КАБАН", "КАЗАК", "КАНАЛ", "КАПЛЯ", "КАРТА", "КАТОК",
                "КЛАСС", "КНИГА", "КОЛОС", "КОНЕЦ", "КОПИЯ", "КРЕСТ", "КРОВЬ",
                "КУКЛА", "ЛАВКА", "ЛАМПА", "ЛИМОН", "ЛОЖКА", "МАГИЯ", "МАСЛО", "МЕСТО", "МЕТРО",
                "НАРОД", "НЕФТЬ", "НУЖДА", "ОГОНЬ", "ОЗЕРО", "УСПЕХ", "АВТОР", "БАГАЖ", "ВЕТКА", "ГЛАЗА", "ЖИЗНЬ", "ИГРОК",
                "УСПЕХ", "АВТОР", "БАГАЖ", "ВЕТКА", "ГЛАЗА", "ЖИЗНЬ", "ИГРОК",
                "КАРТА", "МАСКА", "ПАРТА", "РЫБАК", "ТАБЛО", "ФИЛЬМ", "ШАПКА", "ЭКРАН",
                "АКТЁР", "АМЁБА", "АФЁРА", "АКЦИЯ", "АЛЛЕЯ", "АРМИЯ",
                "БРАВО", "БРАГА", "БРАНЬ", "БРАСС", "БРЕМЯ", "БРЕНД", "БРЕШЬ",
                "ВОПЁЖ", "ВАФЛЯ", "ГАЯТЬ", "ГЛЯСЕ", "ГОЛЯК", "ДОМЁК", "ДВОЯК", "ЗАЛЁТ", "ЗАВЕЯ", "ЗАРЯД", "ЗАТЕЯ",
                "КОВЁР", "КОЗЁЛ", "КОПЬЁ", "КОТЁЛ", "КУЛЁК", "КУТЁЖ",
                "ЛАРЁК", "ЛИКЁР", "ЛИТЬЁ", "ЛАДЬЯ", "ЛАЗНЯ", "ЛЕПНЯ",
                "ЛИЛИЯ", "БИЛЕТ", "КНИГА", "ВЕСНА", "ОГОНЬ", "ДРОВА", "ПЕСОК", "СТЕПЬ", "ГОРОД", "ПТИЦА",
                "РУЧЕЙ", "КАМНИ", "ЛЫЖНЯ", "ЧАЙКА", "САХАР", "СЕДЛО", "ПОЕЗД", "ЛАМПА",
                "ДИВАН", "РУЧКА", "КИСТЬ", "ТАНЕЦ", "ЗАРЯД", "ШАПКА", "ОБУВЬ", "НИТКА", "ТКАНЬ",
                "ЖИЛЕТ", "НОСКИ", "САПОГ", "РАМКА", "ФИЛЬМ", "СЦЕНА", "АКТЁР", "РОЛИК", "ДУБЛЬ", "СЮЖЕТ",
                "МЫСЛЬ", "РИФМА", "БУКВА", "ШКОЛА", "НАУКА", "ХИМИЯ", "ЧИСЛО", "ПАПКА",
                "ТЕКСТ", "ШРИФТ", "СКРИП", "ДОМЕН", "ПОЧТА", "ДРАЙВ"
        );

        // Фильтруем только 5-буквенные слова один раз при инициализации
        this.fiveLetterWords = allWords.stream()
                .filter(word -> word.length() == 5)
                .toList();

        // Создаем Set для быстрой проверки валидности слов
        this.validWords = new HashSet<>(fiveLetterWords);
    }

    /**
     * Получить все слова
     */
    public List<String> getAllWords() {
        return allWords;
    }

    /**
     * Получить только 5-буквенные слова
     */
    public List<String> getFiveLetterWords() {
        return fiveLetterWords;
    }

    /**
     * Проверить, является ли слово валидным
     */
    public boolean isValidWord(String word) {
        return word != null && validWords.contains(word.toUpperCase());
    }

    /**
     * Получить случайное 5-буквенное слово
     */
    public String getRandomFiveLetterWord() {
        if (fiveLetterWords.isEmpty()) {
            throw new IllegalStateException("Нет доступных 5-буквенных слов");
        }
        return fiveLetterWords.get((int) (Math.random() * fiveLetterWords.size()));
    }
}
